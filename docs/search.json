[
  {
    "objectID": "Final.html",
    "href": "Final.html",
    "title": "Data Analysis",
    "section": "",
    "text": "Show code\nfrom pathlib import Path\nimport pandas as pd\nimport geopandas as gpd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nimport osmnx as ox\n\n%matplotlib inline\n\nBASE_DIR = Path(\".\").resolve()\nDATA_DIR = BASE_DIR / \"Data\"\nPROCESSED_DIR = DATA_DIR / \"processed\"\n\nprint(\"Base directory:\", BASE_DIR)\nprint(\"Processed directory:\", PROCESSED_DIR)",
    "crumbs": [
      "Analysis",
      "Data Analysis"
    ]
  },
  {
    "objectID": "Final.html#preliminary-study",
    "href": "Final.html#preliminary-study",
    "title": "Data Analysis",
    "section": "1. Preliminary Study",
    "text": "1. Preliminary Study\n\n1.1 Load processed data\nThis section loads the cleaned block group and station datasets produced in the data cleaning step, and checks basic properties such as the number of rows and the coordinate reference system.\n\n\nShow code\nbg_path = PROCESSED_DIR / \"bg_clean_2272.gpkg\"\nstations_path = PROCESSED_DIR / \"stations_clean_2272.gpkg\"\n\nbg = gpd.read_file(bg_path)\nstations = gpd.read_file(stations_path)\n\nprint(\"Block groups:\", len(bg))\nprint(\"Stations:\", len(stations))\nprint(\"BG CRS:\", bg.crs)\nprint(\"Stations CRS:\", stations.crs)\n\nbg.head()\n\n\n\n\n1.2 Distance to nearest station\nTo measure accessibility to Indego bike-share stations, we calculated the straight-line distance from each census block group to its nearest station. We first generated centroid geometries for all block groups and used sjoin_nearest to identify the closest Indego station for each centroid, storing the resulting distance in feet. These minimum distances were then reattached to the block group dataframe. Finally, we visualized the distribution of block-group-to-station distances using a histogram, providing our first accessibility indicator: the straight-line distance from each block group centroid to the nearest Indego station.\n\n\nShow code\nbg_centroids = bg.copy()\nbg_centroids[\"centroid\"] = bg_centroids.geometry.centroid\nbg_centroids = bg_centroids.set_geometry(\"centroid\")\n\nnearest_station = bg_centroids.sjoin_nearest(\n    stations[[\"geometry\"]],\n    how=\"left\",\n    distance_col=\"dist_to_station_ft\"\n)\n\ndist_to_station = nearest_station.groupby(nearest_station.index)[\"dist_to_station_ft\"].min()\n\nbg[\"dist_to_station_ft\"] = dist_to_station.reindex(bg.index)\n\nbg[[\"GEOID\", \"dist_to_station_ft\"]].head()\n\n\n\n\nShow code\nplt.figure()\nbg[\"dist_to_station_ft\"].dropna().plot(kind=\"hist\", bins=30)\nplt.xlabel(\"Distance to nearest station (feet)\")\nplt.ylabel(\"Number of block groups\")\nplt.title(\"Distribution of distance to nearest Indego station\")\nplt.show()\n\n\n\n\n\n\n\n\n\nThe histogram we plotted examined how far block groups were from their nearest Indego station. The distribution showed that a large share of block groups were located relatively close to a station, forming a clear peak at shorter distances. However, the long right tail of the distribution indicated that many block groups particularly those outside the current Indego service area were much farther away.\nThis pattern reflects the spatial concentration of Indego stations in central Philadelphia: areas close to Center City exhibit very short station distances, while neighborhoods in the outer parts of the city experience substantially reduced access. Overall, the histogram highlighted a noticeable accessibility gap between centrally located and peripheral block groups.\n\n\nShow code\nimport folium\nimport branca.colormap as cm\nfrom branca.element import Template, MacroElement\n\nbg_proj = bg.copy()\nbg_proj[\"centroid\"] = bg_proj.geometry.centroid\nbg_proj = bg_proj.set_geometry(\"centroid\")\n\nbg_poly_wgs = bg.to_crs(epsg=4326).copy()\nbg_centroid_wgs = bg_proj.to_crs(epsg=4326).copy()\n\nbg_poly_wgs[\"dist_to_station_ft\"] = bg[\"dist_to_station_ft\"]\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_dist_poly = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\ndist_min = bg_poly_wgs[\"dist_to_station_ft\"].min()\ndist_max = bg_poly_wgs[\"dist_to_station_ft\"].max()\n\norig_colors = cm.linear.PuRd_09.colors\nrev_colors = list(reversed(orig_colors))\n\ncolormap = cm.LinearColormap(rev_colors, vmin=dist_min, vmax=dist_max)\n\ndef style_fn(feature):\n    d = feature[\"properties\"][\"dist_to_station_ft\"]\n    return {\n        \"fillColor\": colormap(d) if d is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.8,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_fn,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"dist_to_station_ft\"],\n        aliases=[\"GEOID\", \"Distance to station (ft)\"],\n        localize=True\n    )\n).add_to(m_dist_poly)\n\ncolormap.caption = \"Distance to nearest station (ft)\"\ncolormap.add_to(m_dist_poly)\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Distance to Indego Station&lt;/b&gt;&lt;br&gt;\nDarker areas indicate &lt;b&gt;shorter&lt;br&gt;\ndistance&lt;/b&gt; to the nearest station.&lt;br&gt;\nLighter areas represent block&lt;br&gt;\ngroups farther away (in feet).\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_dist_poly.get_root().add_child(legend)\n\nm_dist_poly\n\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nWe also created an interactive map to visualize block-level accessibility to Indego stations. Each block group was shaded according to its straight-line distance to the nearest active station, allowing us to explore spatial patterns in access across Philadelphia. Darker shades represented higher accessibility, meaning the block group was located closer to a station, while lighter areas indicated neighborhoods that faced greater distances and potentially reduced access.\nHovering over a block group revealed a pop-up containing its exact distance value in feet, enabling more precise comparison across locations. This visualization made it clear that most stations were concentrated in central Philadelphia, whereas block groups farther from the urban core showed markedly lower accessibility. The map therefore provided an intuitive overview of the spatial disparities in station placement and helped identify areas that may warrant future expansion.\n\n\n1.3 Station counts within 800 meters\nTo capture local station density, we computed an 800 meter buffer around each block group centroid. Because our projected CRS (EPSG:2272) measures distance in feet, the buffer distance was converted from meters to feet before generating the buffer geometries. We then performed spatial joins between these centroid buffers and the Indego station point dataset.\nAfter identifying all stations that fell within each buffer, we grouped the results by block group and counted the number of stations contained within the walkable 800 meter zone. These counts served as an additional accessibility indicator, representing how many stations were located within a reasonable walking distance of each block group.\n\n\nShow code\nbuffer_800_ft = 800 * 3.28084\n\nbg_centroids[\"buffer_800ft\"] = bg_centroids.geometry.buffer(buffer_800_ft)\n\nbg_800 = gpd.sjoin(\n    bg_centroids.set_geometry(\"buffer_800ft\"),\n    stations[[\"geometry\"]],\n    how=\"left\",\n    predicate=\"contains\"\n)\n\ncount_800 = bg_800.groupby(bg_800.index).size()\n\nbg[\"stations_800m\"] = count_800.reindex(bg.index).fillna(0)\n\nbg[[\"GEOID\", \"stations_800m\"]].head()\n\n\n\n\nShow code\nplt.figure()\nbg[\"stations_800m\"].plot(kind=\"hist\", bins=20)\nplt.xlabel(\"Number of stations within 800 m\")\nplt.ylabel(\"Number of block groups\")\nplt.title(\"Station counts within 800 m of block group centroids\")\nplt.show()\n\n\n\n\n\n\n\n\n\nThe histogram of station counts within the 800 meter buffer showed a strongly right-skewed distribution. Most block groups contained zero or one station within walking distance, indicating relatively limited access for much of the city. A smaller number of block groups had multiple stations within the buffer (in central area), reflecting much higher levels of walkable station availability. This distribution underscored the spatial imbalance in station density across neighborhoods.\n\n\nShow code\nimport folium\nimport branca.colormap as cm\n\nbg_proj = bg.copy()\nbg_proj[\"centroid\"] = bg_proj.geometry.centroid\nbg_proj = bg_proj.set_geometry(\"centroid\")\n\nbg_poly_wgs = bg.to_crs(epsg=4326).copy()\n\nbg_centroid_wgs = bg_proj.to_crs(epsg=4326).copy()\n\nbg_poly_wgs[\"stations_800m\"] = bg[\"stations_800m\"]\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_800_poly = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\ncount_min = bg_poly_wgs[\"stations_800m\"].min()\ncount_max = bg_poly_wgs[\"stations_800m\"].max()\n\norig_colors = cm.linear.Blues_09.colors\ncount_cmap = cm.LinearColormap(orig_colors, vmin=count_min, vmax=count_max)\n\ndef style_800(feature):\n    v = feature[\"properties\"][\"stations_800m\"]\n    return {\n        \"fillColor\": count_cmap(v) if v is not None else \"#cccccc\",\n        \"color\": \"#BCCFD4\", \n        \"weight\": 0.3,\n        \"fillOpacity\": 0.80,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_800,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"stations_800m\"],\n        aliases=[\"GEOID\", \"Stations within 800 m\"],\n        localize=True\n    )\n).add_to(m_800_poly)\n\ncount_cmap.caption = \"Stations within 800 m\"\ncount_cmap.add_to(m_800_poly)\n\nfrom branca.element import Template, MacroElement\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Stations within 800 m&lt;/b&gt;&lt;br&gt;\nChoropleth shading represents&lt;br&gt;\nthe number of stations accessible&lt;br&gt;\nwithin an 800 m distance.\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_800_poly.get_root().add_child(legend)\n\nm_800_poly\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nWe then created an interactive map to visualize the number of stations located within each block group’s 800 meter walking buffer. Darker colors represented block groups with higher station availability, while lighter shades indicated areas with fewer or no stations nearby.\nThe spatial pattern clearly showed that central Philadelphia had the greatest walkable access to Indego stations, with many block groups containing several stations within relatively short distances. In contrast, block groups in West, North, and far South Philadelphia appeared much lighter, revealing limited access and highlighting potential areas for future bike-share expansion.\n\n\n1.4 Proximity to the bicycle network\nTo capture the structure of the city’s bicycle infrastructure, we used OSMnx to extract a bike-specific street network from OpenStreetMap. This network provided a more realistic representation of cycling mobility than simple straight-line measurements and allowed us to assess the spatial distribution of bike infrastructure across Philadelphia.\n\n\nShow code\nox.settings.use_cache = True\nox.settings.log_console = False\n\nG = ox.graph_from_place(\"Philadelphia, Pennsylvania, USA\", network_type=\"bike\")\nbike_edges = ox.graph_to_gdfs(G, nodes=False, edges=True)\n\nbike_edges = bike_edges.to_crs(bg.crs)\n\nnearest_bike = bg_centroids.sjoin_nearest(\n    bike_edges[[\"geometry\"]],\n    how=\"left\",\n    distance_col=\"dist_to_bikelane_ft\"\n)\n\ndist_to_bike = nearest_bike.groupby(nearest_bike.index)[\"dist_to_bikelane_ft\"].min()\nbg[\"dist_to_bikelane_ft\"] = dist_to_bike.reindex(bg.index)\n\nbg[[\"GEOID\", \"dist_to_bikelane_ft\"]].head()\n\n\nWe then computed the distance from each block group centroid to the nearest bike-network edge. Using a nearest-neighbor spatial join (sjoin_nearest) between the centroid geometries and the bike-edge dataset, we recorded the distance as dist_to_bikelane_ft. For block groups where multiple bike edges intersected the same area, we grouped the results by block group index and retained the minimum distance.\nThis process produced our second key accessibility metric: each block group’s proximity to the nearest bike lane, measured in feet.\n\n\nShow code\nplt.figure()\nbg[\"dist_to_bikelane_ft\"].dropna().plot(kind=\"hist\", bins=30)\nplt.xlabel(\"Distance to nearest bike facility (feet)\")\nplt.ylabel(\"Number of block groups\")\nplt.title(\"Distribution of distance to the bicycle network\")\nplt.show()\n\n\n\n\n\n\n\n\n\nWe plotted a histogram of bike-lane distances to examine how cycling accessibility varied across the city. The distribution revealed that many block groups were located relatively close to the bike network, forming a clear peak at shorter distances. However, a long right tail indicated that numerous block groups outside of central core were much more distant from designated bike facilities. This demonstrated substantial variation in infrastructure access across neighborhoods.\n\n\nShow code\nimport folium\nimport branca.colormap as cm\n\nbg_proj = bg.copy()\nbg_proj[\"centroid\"] = bg_proj.geometry.centroid\nbg_proj = bg_proj.set_geometry(\"centroid\")\n\nbg_poly_wgs = bg.to_crs(epsg=4326).copy()\nbg_centroid_wgs = bg_proj.to_crs(epsg=4326).copy()\n\nbg_poly_wgs[\"dist_to_bikelane_ft\"] = bg[\"dist_to_bikelane_ft\"]\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_bike_poly = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\nbike_min = bg_poly_wgs[\"dist_to_bikelane_ft\"].min()\nbike_max = bg_poly_wgs[\"dist_to_bikelane_ft\"].max()\n\norig_colors = cm.linear.YlGnBu_09.colors\nrev_colors = list(reversed(orig_colors))\nbike_cmap = cm.LinearColormap(rev_colors, vmin=bike_min, vmax=bike_max)\n\ndef style_bike(feature):\n    v = feature[\"properties\"][\"dist_to_bikelane_ft\"]\n    return {\n        \"fillColor\": bike_cmap(v) if v is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_bike,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"dist_to_bikelane_ft\"],\n        aliases=[\"GEOID\", \"Distance to bike facility (ft)\"],\n        localize=True\n    )\n).add_to(m_bike_poly)\n\n# Add the colorbar\nbike_cmap.caption = \"Distance to nearest bike facility (ft)\"\nbike_cmap.add_to(m_bike_poly)\n\n# Add descriptive legend box\nfrom branca.element import Template, MacroElement\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Distance to Bike Network&lt;/b&gt;&lt;br&gt;\nDarker areas indicate &lt;b&gt;shorter distance&lt;/b&gt;&lt;br&gt;\n(closer to a bike lane).&lt;br&gt;\nLighter areas are farther away.\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_bike_poly.get_root().add_child(legend)\n\nm_bike_poly\n\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nWe visualized the distance-to-bike-lane metric through an interactive map. Darker shading represented block groups that were closer to the bike network, indicating stronger bicycle infrastructure access, while lighter shading marked areas farther from designated bike facilities.\nThe map showed that most block groups across Philadelphia were relatively close to at least one bike facility, with large portions of the city appearing in darker blue tones. However, a small number of block groups on the outer edges of the city, particularly in far South Philadelphia and parts of the Northeast, stood out in much lighter colors. These pockets highlighted locations where residents were substantially farther from the bike network and where future connections or extensions could be most impactful.",
    "crumbs": [
      "Analysis",
      "Data Analysis"
    ]
  },
  {
    "objectID": "Final.html#need-score",
    "href": "Final.html#need-score",
    "title": "Data Analysis",
    "section": "2. Need Score",
    "text": "2. Need Score\nWe first computed transportation-related social needs at the census block group level using ACS 2023 variables. Total population, median household income, zero-vehicle households, and bicycle commuters served as indicators of transportation need. Median household income was used as a proxy for economic vulnerability, while zero-vehicle households and bicycle commuters were treated as indicators of dependence on non-automobile modes.\nAll components were converted to numeric form and rescaled to a 0–1 range using the custom minmax() function. Because lower incomes represent higher need, the income component was inverted after scaling. The three standardized components—income (inverted), zero-vehicle households, and bicycle commuters—were then averaged to create a single need_score for each block group.\nThe need score combines three indicators at the block group level:\n\nMedian household income. Lower income suggests greater need for affordable transport options.\nZero vehicle households as a share of all households. More households without cars indicates stronger dependence on shared mobility.\nBicycle commuters as a share of the population. A higher bicycle commuting share suggests stronger reliance on bicycle friendly conditions.\n\nAll three indicators are scaled to a zero to one range before being combined.\n\n\nShow code\nimport numpy as np\n\ndef minmax(series):\n    s = pd.to_numeric(series, errors=\"coerce\")\n    s_min = s.min()\n    s_max = s.max()\n    return (s - s_min) / (s_max - s_min)\n\npop = pd.to_numeric(bg[\"B01003_001E\"], errors=\"coerce\")\n\nmedian_income = pd.to_numeric(bg[\"B19013_001E\"], errors=\"coerce\")\n\nzero_vehicle = pd.to_numeric(bg[\"B25044_003E\"], errors=\"coerce\").fillna(0)\n\nbike_commuters = pd.to_numeric(bg[\"B08301_018E\"], errors=\"coerce\").fillna(0)\n\nzero_vehicle_rate = zero_vehicle / pop.replace(0, np.nan)\nbike_share = bike_commuters / pop.replace(0, np.nan)\n\nincome_scaled = minmax(median_income)\nneed_income = 1 - income_scaled\n\nneed_zero_vehicle = minmax(zero_vehicle_rate)\nneed_bike_share = minmax(bike_share)\n\nbg[\"need_income\"] = need_income\nbg[\"need_zero_vehicle\"] = need_zero_vehicle\nbg[\"need_bike_share\"] = need_bike_share\n\nbg[\"need_score\"] = (need_income + need_zero_vehicle + need_bike_share) / 3\n\nbg[[\"need_income\", \"need_zero_vehicle\", \"need_bike_share\", \"need_score\"]].head()\n\n\n\n\nShow code\nplt.figure()\nbg[\"need_score\"].dropna().plot(kind=\"hist\", bins=30)\nplt.xlabel(\"Need score\")\nplt.ylabel(\"Number of block groups\")\nplt.title(\"Distribution of need score\")\nplt.show()\n\n\n\n\n\n\n\n\n\nWe then examined the distribution of the need score using a histogram. The distribution showed a concentration of block groups in the mid-to-high range of need, with fewer block groups exhibiting extremely low scores. This pattern suggested that transportation-related need was widespread across the city, though certain neighborhoods demonstrated substantially higher levels of vulnerability than others.\n\n\nShow code\nimport folium\nimport branca.colormap as cm\n\nbg_proj = bg.copy()\nbg_proj[\"centroid\"] = bg_proj.geometry.centroid\nbg_proj = bg_proj.set_geometry(\"centroid\")\n\nbg_poly_wgs = bg.to_crs(epsg=4326).copy()\nbg_centroid_wgs = bg_proj.to_crs(epsg=4326).copy()\n\nbg_poly_wgs[\"need_score\"] = bg[\"need_score\"]\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_need = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\nneed_min = bg_poly_wgs[\"need_score\"].min()\nneed_max = bg_poly_wgs[\"need_score\"].max()\n\norig_colors = cm.linear.Purples_09.colors\nneed_cmap = cm.LinearColormap(orig_colors, vmin=need_min, vmax=need_max)\n\ndef style_need(feature):\n    v = feature[\"properties\"][\"need_score\"]\n    return {\n        \"fillColor\": need_cmap(v) if v is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_need,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"need_score\"],\n        aliases=[\"GEOID\", \"Need score\"],\n        localize=True\n    )\n).add_to(m_need)\n\nneed_cmap.caption = \"Need score\"\nneed_cmap.add_to(m_need)\n\n\nfrom branca.element import Template, MacroElement\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Need Score&lt;/b&gt;&lt;br&gt;\nDarker areas indicate census&lt;br&gt;\nblock groups with &lt;b&gt;higher need&lt;/b&gt;.\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_need.get_root().add_child(legend)\n\nm_need\n\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nWe also mapped the spatial pattern of the need score across Philadelphia. Darker shades represented block groups with higher levels of transportation need.\nThe spatial distribution revealed that higher-need areas were concentrated in North Philadelphia, West Philadelphia, and portions of the Lower Northeast—neighborhoods that often exhibit lower incomes and greater reliance on non-automobile travel modes. In contrast, Center City and several higher-income areas displayed lighter need scores, reflecting lower levels of socioeconomic vulnerability. This map provided a clear geographic picture of where bike infrastructure investment may offer the greatest social benefit.",
    "crumbs": [
      "Analysis",
      "Data Analysis"
    ]
  },
  {
    "objectID": "Final.html#access-score",
    "href": "Final.html#access-score",
    "title": "Data Analysis",
    "section": "3. Access Score",
    "text": "3. Access Score\nTo synthesize multiple accessibility indicators into a single measure, we defined three core components: (1) the number of Indego stations within an 800 meter buffer (stations_within_800m), (2) the straight-line distance to the nearest station (dist_to_station_ft), and (3) the distance to the nearest bike lane (dist_to_bikelane_ft).\nAll three variables were first coerced to numeric form. Each component was then scaled to a 0–1 range using the minmax() function. For the two distance-based indicators, we multiplied values by −1 prior to scaling so that shorter distances corresponded to higher access levels. This produced three standardized components that reflected station density, proximity to stations, and proximity to bike lanes.\nThe access score combines three indicators:\n\nNumber of stations within eight hundred meters of each block group centroid.\nDistance to the nearest Indego station.\nDistance to the nearest bicycle facility.\n\nStation counts increase access, while shorter distances to stations and bicycle facilities indicate better access. Distances are inverted before scaling so that higher values always represent better access.\n\n\nShow code\nstations_800m = pd.to_numeric(bg[\"stations_800m\"], errors=\"coerce\")\ndist_station = pd.to_numeric(bg[\"dist_to_station_ft\"], errors=\"coerce\")\ndist_bikelane = pd.to_numeric(bg[\"dist_to_bikelane_ft\"], errors=\"coerce\")\n\nacc_stations = minmax(stations_800m)\nacc_dist_station = minmax(-dist_station)\nacc_dist_bikelane = minmax(-dist_bikelane)\n\nbg[\"acc_stations\"] = acc_stations\nbg[\"acc_dist_station\"] = acc_dist_station\nbg[\"acc_dist_bikelane\"] = acc_dist_bikelane\n\nbg[\"access_score\"] = (acc_stations + acc_dist_station + acc_dist_bikelane) / 3\n\nbg[[\"acc_stations\", \"acc_dist_station\", \"acc_dist_bikelane\", \"access_score\"]].head()\n\n\nThe final access_score for each block group was calculated as the mean of the three standardized components. We summarized the distribution of the resulting score using descriptive statistics and a histogram to understand variation in access across the city.\n\n\nShow code\nplt.figure()\nbg[\"access_score\"].dropna().plot(kind=\"hist\", bins=30)\nplt.xlabel(\"Access score\")\nplt.ylabel(\"Number of block groups\")\nplt.title(\"Distribution of access score\")\nplt.show()\n\n\n\n\n\n\n\n\n\nThe histogram of access scores showed a strong skew toward lower and moderate access levels, with relatively few block groups achieving high overall accessibility. This indicated that while a small portion of the city benefited from strong multimodal access, most neighborhoods exhibited substantially lower levels of access to bike-share stations and bike infrastructure.\n\n\nShow code\nbg_proj = bg.copy()\nbg_proj[\"centroid\"] = bg_proj.geometry.centroid\nbg_proj = bg_proj.set_geometry(\"centroid\")\n\nbg_poly_wgs = bg.to_crs(epsg=4326).copy()\nbg_centroid_wgs = bg_proj.to_crs(epsg=4326).copy()\n\nbg_poly_wgs[\"access_score\"] = bg[\"access_score\"]\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_access = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\naccess_min = bg_poly_wgs[\"access_score\"].min()\naccess_max = bg_poly_wgs[\"access_score\"].max()\n\norig_colors = cm.linear.Blues_09.colors\naccess_cmap = cm.LinearColormap(orig_colors, vmin=access_min, vmax=access_max)\n\ndef style_access(feature):\n    v = feature[\"properties\"][\"access_score\"]\n    return {\n        \"fillColor\": access_cmap(v) if v is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_access,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"access_score\"],\n        aliases=[\"GEOID\", \"Access score\"],\n        localize=True\n    )\n).add_to(m_access)\n\naccess_cmap.caption = \"Access score\"\naccess_cmap.add_to(m_access)\n\nfrom branca.element import Template, MacroElement\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Access Score&lt;/b&gt;&lt;br&gt;\nDarker areas indicate census&lt;br&gt;\nblock groups with &lt;b&gt;better access&lt;/b&gt;&lt;br&gt;\nto existing Indego stations&lt;br&gt;\nand bike network.\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_access.get_root().add_child(legend)\n\nm_access\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nThe map of access scores visualized the spatial distribution of bicycle infrastructure accessibility across Philadelphia. Darker areas represented block groups with higher access, while lighter areas indicated lower levels of access.\nThe spatial pattern showed that accessibility was overwhelmingly concentrated in central Philadelphia, where station density is highest and bike lanes are more extensive. Surrounding neighborhoods in West, North, and Northeast Philadelphia appeared significantly lighter, reflecting limited proximity to both stations and the bike network. These disparities highlighted the uneven geography of bicycle infrastructure access and pointed to clear areas where system expansion could improve regional mobility.",
    "crumbs": [
      "Analysis",
      "Data Analysis"
    ]
  },
  {
    "objectID": "Final.html#equity-gap",
    "href": "Final.html#equity-gap",
    "title": "Data Analysis",
    "section": "4. Equity Gap",
    "text": "4. Equity Gap\nTo quantify equity differences across Philadelphia, we began by computing an equity gap for each census block group, defined as:\nequity_gap=need_score−access_score\nPositive values indicate locations where social need exceeds access to bike-share infrastructure, while negative values reflect areas where access is relatively stronger.\nTo support citywide comparison, we classified the equity gap into quartiles using qcut, assigning each block group to one of four categories (“Lowest,” “Medium low,” “Medium high,” and “Highest”). These quartile groups create an interpretable typology that can be used for mapping and prioritizing neighborhoods.\nWe then plotted a histogram of the equity gap values to examine their overall distribution and identify how many block groups fall into high- or low-gap ranges. Then we visualized the relationship between need and access directly by plotting block-group need scores against access scores in a scatterplot. Points are colored by their equity gap, and a 45-degree reference line indicates perfect alignment between need and access. This visualization highlights which areas have disproportionately low access relative to their measured social need.\n\n\nShow code\nbg[\"equity_gap\"] = bg[\"need_score\"] - bg[\"access_score\"]\n\nbg[\"equity_gap_q\"] = pd.qcut(\n    bg[\"equity_gap\"],\n    q=4,\n    labels=[\"Lowest\", \"Medium low\", \"Medium high\", \"Highest\"]\n)\n\nbg[[\"need_score\", \"access_score\", \"equity_gap\", \"equity_gap_q\"]].head()\n\n\n\n\nShow code\nplt.figure()\nbg[\"equity_gap\"].dropna().plot(kind=\"hist\", bins=30)\nplt.xlabel(\"Equity gap (need minus access)\")\nplt.ylabel(\"Number of block groups\")\nplt.title(\"Distribution of equity gap\")\nplt.show()\n\n\n\n\n\n\n\n\n\nThe histogram of equity gap values showed a distribution centered around moderately negative scores, with most block groups falling between approximately −0.45 and −0.20. This pattern indicated that, for much of the city, infrastructure access exceeded measured social need to some degree. A smaller number of block groups exhibited strongly negative values, while very few approached zero, meaning that only a limited set of neighborhoods had need levels that nearly matched their access levels. Overall, the distribution suggested a broad mismatch between access and need, with underserved areas emerging primarily where equity gap values were closer to zero rather than in the strongly negative range.\n\n\nShow code\nplt.figure()\nsc = plt.scatter(\n    bg[\"access_score\"],\n    bg[\"need_score\"],\n    c=bg[\"equity_gap\"],\n    cmap=\"coolwarm\",\n    alpha=0.7\n)\nplt.xlabel(\"Access score\")\nplt.ylabel(\"Need score\")\nplt.title(\"Need and access scores by block group\")\nplt.colorbar(sc, label=\"Equity gap\")\n\nplt.plot([0, 1], [0, 1], linestyle=\"--\", color=\"gray\")\nplt.show()\n\n\n\n\n\n\n\n\n\nThe scatterplot comparing need and access scores provided a clear visual summary of equity conditions across Philadelphia. Each point represented a block group, colored by its equity gap value. Most points fell below the 45-degree reference line, indicating that access was generally higher than measured need throughout much of the city.\nBlock groups shaded in red were located nearer to the reference line, meaning their transportation need exceeded or nearly matched their access level. These areas represented the relatively underserved neighborhoods. In contrast, the blue-shaded points, located well below the reference line, reflected block groups where access substantially exceeded need.\nThe wide horizontal spread of access scores compared to the more compressed vertical distribution of need scores suggested that variation in infrastructure access was the primary driver of equity differences rather than variation in underlying social need.\n\n\nShow code\nimport folium\nimport branca.colormap as cm\nfrom branca.element import Template, MacroElement\n\nbg_proj = bg.copy()\nbg_proj[\"centroid\"] = bg_proj.geometry.centroid\nbg_proj = bg_proj.set_geometry(\"centroid\")\n\nbg_poly_wgs = bg.to_crs(epsg=4326).copy()\nbg_centroid_wgs = bg_proj.to_crs(epsg=4326).copy()\n\nbg_poly_wgs[\"equity_gap\"] = bg[\"equity_gap\"]\nbg_poly_wgs[\"equity_gap_q\"] = bg[\"equity_gap_q\"].astype(str)\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_gap = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\ngap_min = bg_poly_wgs[\"equity_gap\"].min()\ngap_max = bg_poly_wgs[\"equity_gap\"].max()\n\norig_colors = cm.linear.RdYlBu_11.colors\nrev_colors = list(reversed(orig_colors))\ngap_cmap = cm.LinearColormap(rev_colors, vmin=gap_min, vmax=gap_max)\n\ndef style_gap(feature):\n    v = feature[\"properties\"][\"equity_gap\"]\n    return {\n        \"fillColor\": gap_cmap(v) if v is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_gap,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"need_score\", \"access_score\", \"equity_gap\", \"equity_gap_q\"],\n        aliases=[\"GEOID\", \"Need\", \"Access\", \"Equity gap\", \"Gap quartile\"],\n        localize=True\n    )\n).add_to(m_gap)\n\ngap_cmap.caption = \"Equity gap (need minus access)\"\ngap_cmap.add_to(m_gap)\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Equity Gap&lt;/b&gt;&lt;br&gt;\nComputed as &lt;b&gt;need score minus&lt;br&gt;\naccess score&lt;/b&gt; for each block group.&lt;br&gt;&lt;br&gt;\nWarmer (red) areas indicate&lt;br&gt;\n&lt;b&gt;higher equity gaps&lt;/b&gt; where need&lt;br&gt;\nis high but access is low.&lt;br&gt;\nCooler (blue) areas indicate&lt;br&gt;\n&lt;b&gt;lower equity gaps&lt;/b&gt;.\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_gap.get_root().add_child(legend)\n\nm_gap\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nFor the final results, we used Folium to build interactive web maps that visualize need, access, and equity gaps at the block group level. All geometries were reprojected to WGS84 (EPSG:4326) for compatibility with web mapping basemaps.\nWe first created a single-layer equity gap map in which each block group was colored according to its quartile category using a custom diverging color scheme. GeoJSON tooltips displayed each block group’s GEOID, raw equity gap value, and assigned quartile. An accompanying HTML legend clarified the meaning of the color categories.\nThe equity gap map highlights where social need exceeds access to bicycle infrastructure. Warmer colors (orange to red) represent block groups with higher equity gap values, meaning these neighborhoods have relatively higher transportation need but lower access to bike lanes or Indego stations. These areas appear most prominently in Northeast and North Philadelphia, as well as parts of Upper Northwest.\nCooler colors (light to dark blue) indicate areas where access is comparatively high relative to measured need. These clusters are concentrated around Center City and University City, where bike lanes and Indego stations are densest.\nThe strong spatial contrast between central Philadelphia and the outlying neighborhoods suggests that current bicycle infrastructure investments are unevenly distributed, with underserved areas located primarily farther from the city’s existing bike network.",
    "crumbs": [
      "Analysis",
      "Data Analysis"
    ]
  },
  {
    "objectID": "Final.html#interactive-map",
    "href": "Final.html#interactive-map",
    "title": "Data Analysis",
    "section": "5. Interactive Map",
    "text": "5. Interactive Map\n\n\nShow code\nimport folium\nimport branca.colormap as cm\nimport geopandas as gpd\n\nstations_2272 = gpd.read_file(PROCESSED_DIR / \"stations_clean_2272.gpkg\", layer=\"stations\")\nstations_wgs = stations_2272.to_crs(epsg=4326).copy()\n\n\nbg_wgs = bg.to_crs(epsg=4326).copy()\n\ncenter_lat = bg_wgs.geometry.centroid.y.mean()\ncenter_lon = bg_wgs.geometry.centroid.x.mean()\n\nm_all = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\nneed_min = bg_wgs[\"need_score\"].min()\nneed_max = bg_wgs[\"need_score\"].max()\n\nneed_cmap = cm.LinearColormap(\n    cm.linear.Purples_09.colors,\n    vmin=need_min,\n    vmax=need_max\n)\n\nneed_fg = folium.FeatureGroup(name=\"Need Score\", show=False)\n\ndef style_need(feature):\n    val = feature[\"properties\"][\"need_score\"]\n    return {\n        \"fillColor\": need_cmap(val) if val is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_wgs,\n    style_function=style_need,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"need_score\"],\n        aliases=[\"GEOID\", \"Need score\"],\n        localize=True\n    )\n).add_to(need_fg)\n\nneed_fg.add_to(m_all)\n\naccess_min = bg_wgs[\"access_score\"].min()\naccess_max = bg_wgs[\"access_score\"].max()\n\naccess_cmap = cm.LinearColormap(\n    cm.linear.Blues_09.colors,\n    vmin=access_min,\n    vmax=access_max\n)\n\naccess_fg = folium.FeatureGroup(name=\"Access Score\", show=False)\n\ndef style_access(feature):\n    val = feature[\"properties\"][\"access_score\"]\n    return {\n        \"fillColor\": access_cmap(val) if val is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_wgs,\n    style_function=style_access,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"access_score\"],\n        aliases=[\"GEOID\", \"Access score\"],\n        localize=True\n    )\n).add_to(access_fg)\n\naccess_fg.add_to(m_all)\n\ngap_min = bg_wgs[\"equity_gap\"].min()\ngap_max = bg_wgs[\"equity_gap\"].max()\n\ngap_cmap = cm.LinearColormap(\n    list(reversed(cm.linear.RdYlBu_11.colors)),\n    vmin=gap_min,\n    vmax=gap_max\n)\n\ngap_fg = folium.FeatureGroup(name=\"Equity Gap (Need minus Access)\", show=True)\n\ndef style_gap(feature):\n    val = feature[\"properties\"][\"equity_gap\"]\n    return {\n        \"fillColor\": gap_cmap(val) if val is not None else \"#cccccc\",\n        \"color\": \"#ffffff\",\n        \"weight\": 0.3,\n        \"fillOpacity\": 0.85,\n    }\n\nfolium.GeoJson(\n    bg_wgs,\n    style_function=style_gap,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\"GEOID\", \"need_score\", \"access_score\", \"equity_gap\"],\n        aliases=[\"GEOID\", \"Need\", \"Access\", \"Equity gap\"],\n        localize=True\n    )\n).add_to(gap_fg)\n\ngap_fg.add_to(m_all)\n\ngap_cmap.caption = \"Equity Gap (Need minus Access)\"\ngap_cmap.add_to(m_all)\n\nstations_fg = folium.FeatureGroup(name=\"Indego Stations\", show=True)\n\nfor _, row in stations_wgs.iterrows():\n    folium.CircleMarker(\n        location=[row.geometry.y, row.geometry.x],\n        radius=2,\n        color=\"#004c6d\",\n        fill=True,\n        fill_opacity=0.9,\n        popup=row.get(\"name\", \"Indego station\")\n    ).add_to(stations_fg)\n\nstations_fg.add_to(m_all)\n\nfolium.LayerControl(collapsed=False).add_to(m_all)\n\nlegend_html = \"\"\"\n&lt;div style=\"\n     position: fixed;\n     bottom: 20px; left: 20px;\n     z-index: 9999;\n     background-color: white;\n     padding: 10px 12px;\n     border: 1px solid #ccc;\n     border-radius: 4px;\n     box-shadow: 0 1px 4px rgba(0,0,0,0.2);\n     font-size: 12px;\n\"&gt;\n&lt;b&gt;Layer guide&lt;/b&gt;&lt;br&gt;\n&lt;span style=\"color:#6b4c9a;\"&gt;■&lt;/span&gt; Need score – darker purple means higher need&lt;br&gt;\n&lt;span style=\"color:#2166ac;\"&gt;■&lt;/span&gt; Access score – darker blue means higher access&lt;br&gt;\n&lt;span style=\"color:#b2182b;\"&gt;■&lt;/span&gt; Equity gap – red means higher gap where need is high and access is low&lt;br&gt;\n&lt;span style=\"color:#2166ac;\"&gt;■&lt;/span&gt; Equity gap – blue means lower gap where access is closer to or above need\n&lt;/div&gt;\n\"\"\"\n\nm_all.get_root().html.add_child(folium.Element(legend_html))\n\nm_all\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nFor final results visualization, we used Folium to build interactive web maps that allow exploration of need, access, and the equity gap at the block group level. All geometries were converted to WGS84 (EPSG:4326) for web mapping.\nFirst, we created a single-layer equity gap map where each block group is colored by its quartile category using a custom diverging color scheme. The map includes GeoJSON tooltips showing the GEOID, raw equity gap value, and gap category, as well as an HTML legend explaining the color categories. Next, we constructed a more comprehensive multi-layer map with separate FeatureGroups for: Need score (purple gradient), access score (blue gradient), equity gap (need − access) (diverging red–blue colormap), and Indego stations (point markers)\nEach layer has its own styling function and tooltips displaying relevant attribute values. A LayerControl widget allows users to toggle between need, access, and gap views, while an on-map legend explains how to interpret the colors. This interactive visualization supports richer exploration of spatial equity patterns beyond static figures.\n\n\nShow code\nbg_scores_path = PROCESSED_DIR / \"bg_scores_2272.gpkg\"\nbg.to_file(bg_scores_path, layer=\"scores\", driver=\"GPKG\")\nprint(\"Saved:\", bg_scores_path)",
    "crumbs": [
      "Analysis",
      "Data Analysis"
    ]
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "Equitable Access to Bike Infrastructure in Philadelphia",
    "section": "Introduction",
    "text": "Introduction\nAs one of the key transportation modes in residents’ daily lives, cycling plays a crucial role in shaping mobility and public space in Philadelphia. In recent years, the demand for safe, connected, and equitable bicycle infrastructure has continued to grow. However, access to bike lanes and shared mobility options remains uneven across neighborhoods, raising important questions about equity and transportation justice.\nThis project examines the equity of access to bicycle infrastructure in Philadelphia, drawing inspiration from the City’s Vision Zero 2030 goals and its broader equity agenda. Our analysis provides a data-driven evaluation of who currently benefits from the existing Indego bike network and where gaps in access may persist.\nThe project is guided by two overarching questions:\n\nAre bike lanes and Indego stations equitably accessible across Philadelphia’s neighborhoods\n\nHow can this analysis inform future bike infrastructure expansion so that it aligns with the city’s goals for equity and safety\n\nTo address these questions, we focus on four research components:\n\nWhich areas of the city have high or low access to bicycle infrastructure\n\nHow access patterns correlate with socioeconomic and demographic characteristics\n\nWhether a composite Equitable Access Index (EAI) can be developed\n\nWhich neighborhoods should be prioritized for future Indego station expansion\n\nThis overview summarizes the motivation for the project and frames the analytical steps presented throughout the site.",
    "crumbs": [
      "Project Overview"
    ]
  },
  {
    "objectID": "index.html#data-sources",
    "href": "index.html#data-sources",
    "title": "Equitable Access to Bike Infrastructure in Philadelphia",
    "section": "Data Sources",
    "text": "Data Sources\nOur analysis draws from four primary data sources, each contributing a different dimension to understanding access and equity in Philadelphia’s bike infrastructure system.\n\n1. ACS 2023 Five-Year Estimates\nWe used demographic and socioeconomic variables from the American Community Survey, including median household income, total population, and zero-vehicle households. These indicators help quantify social need and allow us to examine how bicycle access correlates with neighborhood characteristics.\n\n\n2. Indego Bike Share Data\nWe obtained the locations of Indego bike-share stations to measure proximity and accessibility to the system. These data help identify which areas currently benefit from bike-share coverage and which remain underserved.\n\n\n3. OpenDataPhilly: Neighborhood and Census Block Group Boundaries\nSpatial boundary files for Philadelphia’s neighborhoods and census block groups provide the geographic units for our analysis. These geometries serve as the base for spatial joins, accessibility calculations, and equity comparisons across neighborhoods.\n\n\n4. OSMnx Street Network\nUsing OSMnx, we extracted Philadelphia’s street network and built a bike-specific network. This enables more accurate infrastructure access measurements, including shortest-path distances to bike lanes and Indego stations, rather than relying on simple straight-line distances.",
    "crumbs": [
      "Project Overview"
    ]
  },
  {
    "objectID": "index.html#methodology",
    "href": "index.html#methodology",
    "title": "Equitable Access to Bike Infrastructure in Philadelphia",
    "section": "Methodology",
    "text": "Methodology\nThis project follows an eight-step analytical pipeline to evaluate accessibility and equity across Philadelphia’s bicycle infrastructure system.\n\n1. Data Collection\nWe first collected data from multiple sources, including ACS socioeconomic indicators, Indego station locations, block group boundaries, and the Philadelphia street network. These datasets provide the demographic, spatial, and network foundations for the analysis.\n\n\n2. Cleaning and Processing\nAll datasets were cleaned, filtered, and projected into a consistent coordinate system to ensure compatibility. Demographic variables were selected and aggregated at the census block group level, allowing for neighborhood-scale comparison.\n\n\n3. Building the Bike Network\nUsing OSMnx, we extracted Philadelphia’s street network and constructed a bike-specific routing network. This supports more realistic distance calculations than straight-line methods.\n\n\n4. Measuring Accessibility\nFor each census block group, we calculated accessibility metrics such as network distance to the nearest bike lane and distance to the nearest Indego station. These values quantify how easily residents can reach bicycle infrastructure.\n\n\n5. Joining with ACS Demographics\nAccessibility metrics were linked with socioeconomic indicators such as median income, population, and zero-vehicle households. This integration allows us to compare infrastructure access with underlying neighborhood characteristics.\n\n\n6. Constructing Need and Access Scores\nWe normalized demographic variables to develop a Need Score and standardized accessibility values to create an Access Score. Together, these metrics provide a consistent basis for identifying inequities in infrastructure distribution.\n\n\n7. Equity Gap Analysis\nBy comparing social need with infrastructure access, we created an Equity Gap Index for each block group. Areas with high need but low access were identified as potential priority zones for future bike-share or bike-lane investments.\n\n\n8. Mapping and Visualization\nResults were visualized through choropleth maps, interactive Folium layers, and ranked priority lists. These visualizations help interpret spatial patterns and support data-driven planning decisions.",
    "crumbs": [
      "Project Overview"
    ]
  },
  {
    "objectID": "index.html#requirements-met",
    "href": "index.html#requirements-met",
    "title": "Equitable Access to Bike Infrastructure in Philadelphia",
    "section": "Requirements Met",
    "text": "Requirements Met\nThis project aims to meet the following assignment requirements:\nData Collection:\nData is collected through a means more sophisticated than downloading (API).\nData Sources:\nIt combines data collected from 4 different sources.\nSpatial Analysis:\nThe analysis of the data is reasonably complex (geospatial joins/operations, etc.).\nStreet Network:\nUse OSMnx or pandana to analyze street networks.\nInteractive Visuals:\nInclude multiple interactive visualizations with interactivity (cross-filtering, widgets, etc.).",
    "crumbs": [
      "Project Overview"
    ]
  },
  {
    "objectID": "index.html#about-the-researchers",
    "href": "index.html#about-the-researchers",
    "title": "Equitable Access to Bike Infrastructure in Philadelphia",
    "section": "About the Researchers",
    "text": "About the Researchers\nShijie (Chelsea) Cao and Xueer (Andrea) Wu are two Master students of City Planning at the University of Pennsylvania. This project was completed for MUSA 5500: Geospatial Data Science in Python.",
    "crumbs": [
      "Project Overview"
    ]
  },
  {
    "objectID": "DataCleaning.html",
    "href": "DataCleaning.html",
    "title": "Data Processing",
    "section": "",
    "text": "Show code\nfrom pathlib import Path\nimport pandas as pd\nimport geopandas as gpd\nimport requests\nimport censusdata\n\nBASE_DIR = Path(\".\").resolve()\nDATA_DIR = BASE_DIR / \"Data\"\nRAW_DIR = DATA_DIR / \"raw\"\nPROCESSED_DIR = DATA_DIR / \"processed\"\nPROCESSED_DIR.mkdir(parents=True, exist_ok=True)",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "DataCleaning.html#data-collection",
    "href": "DataCleaning.html#data-collection",
    "title": "Data Processing",
    "section": "1.1 Data Collection",
    "text": "1.1 Data Collection\nWe first set up a clear project directory structure using pathlib, defining base, raw, and processed data folders. We then load Philadelphia census block group polygons from the GeoJSON file obtained from OpenDataPhilly. Census block groups serve as our spatial unit of analysis because they provide an appropriate balance between demographic detail, geographic precision, and data availability for evaluating bicycle infrastructure equity in Philadelphia. We also inspect the number of block groups and the coordinate reference system (CRS) to confirm that the spatial units are suitable for further analysis.\n\n\nShow code\nbg_path = RAW_DIR / \"Census_Block_Groups_2010.geojson\"\nblock_groups = gpd.read_file(bg_path)",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "DataCleaning.html#load-acs-2023-5-year-data-via-censusdata",
    "href": "DataCleaning.html#load-acs-2023-5-year-data-via-censusdata",
    "title": "Data Processing",
    "section": "1.2 Load ACS 2023 5-Year Data via censusdata",
    "text": "1.2 Load ACS 2023 5-Year Data via censusdata\nTo access socioeconomic variables at the block group level within Philadelphia County, we use the censusdata package to download 2023 ACS 5-year estimates. The selected variables include total population, median household income, zero-vehicle households, and bicycle commuters.\nBecause the ACS download uses a hierarchical geography index, we reconstruct a full 12-digit GEOID by defining a helper function make_geoid_full that concatenates state, county, tract, and block group codes from x.geo. This reconstructed GEOID is then used to merge the ACS dataset with the block group geometries using a left join. ACS error codes and placeholder values are replaced with NaN to ensure the dataset is clean and reliable for further analysis.\n\n\nShow code\nacs_vars = [\n    \"B01003_001E\",\n    \"B19013_001E\",\n    \"B25044_003E\",\n    \"B08301_018E\",\n]\n\nacs_2023 = censusdata.download(\n    \"acs5\",\n    2023,\n    censusdata.censusgeo([\n        (\"state\", \"42\"),\n        (\"county\", \"101\"),\n        (\"block group\", \"*\"),\n    ]),\n    acs_vars,\n)\n\n\n\n\nShow code\ndef make_geoid(x):\n    state = x.geo[0][1]\n    county = x.geo[1][1]\n    tract = x.geo[2][1]\n    blkgrp = x.geo[3][1]\n    return state + county + tract + blkgrp\n\nacs_2023[\"GEOID\"] = acs_2023.index.to_series().apply(make_geoid)\n\nif \"GEOID10\" in block_groups.columns:\n    block_groups = block_groups.rename(columns={\"GEOID10\": \"GEOID\"})\n\nblock_groups_acs = block_groups.merge(\n    acs_2023,\n    on=\"GEOID\",\n    how=\"left\",\n).copy()\n\nblock_groups_acs = block_groups_acs.replace(\n    [-666666666, -666666667, -222222222],\n    pd.NA,\n)\n\n\n\n\nShow code\nblock_groups_acs = block_groups_acs.replace(\n    [-666666666, -666666667, -222222222],\n    pd.NA,\n)\n\nblock_groups_acs[[\"B01003_001E\", \"B19013_001E\", \"B25044_003E\", \"B08301_018E\"]].describe()",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "DataCleaning.html#load-indego-station-data",
    "href": "DataCleaning.html#load-indego-station-data",
    "title": "Data Processing",
    "section": "1.3 Load Indego Station Data",
    "text": "1.3 Load Indego Station Data\nFor Indego station locations, we access the real-time API endpoint to retrieve live station data. The returned GeoJSON is parsed into a GeoDataFrame with CRS EPSG:4326. This ensures that the station dataset is up to date and ready for spatial processing.\n\n\nShow code\nstations_url = \"https://bts-status.bicycletransit.workers.dev/phl\"\nresponse = requests.get(stations_url)\nresponse.raise_for_status()\n\ndata = response.json()\nfeatures = data[\"features\"]\n\nstations_gdf = gpd.GeoDataFrame.from_features(features, crs=\"EPSG:4326\")\nprint(\"Number of stations:\", len(stations_gdf))\nstations_gdf.head()",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "DataCleaning.html#reproject-coordinate-systems",
    "href": "DataCleaning.html#reproject-coordinate-systems",
    "title": "Data Processing",
    "section": "1.4 Reproject Coordinate Systems",
    "text": "1.4 Reproject Coordinate Systems\nTo perform accurate distance calculations, both census block groups and Indego stations are reprojected into a common projected CRS: EPSG:2272. This projection allows distance to be measured in feet and ensures consistency across all geospatial operations.\n\n\nShow code\nstations_url = \"https://bts-status.bicycletransit.workers.dev/phl\"\nresponse = requests.get(stations_url)\nresponse.raise_for_status()\ndata = response.json()\n\nfeatures = data[\"features\"]\nstations_gdf = gpd.GeoDataFrame.from_features(features, crs=\"EPSG:4326\")\n\nTARGET_CRS = \"EPSG:2272\"\nbg_proj = block_groups_acs.to_crs(TARGET_CRS).copy()\nstations_proj = stations_gdf.to_crs(TARGET_CRS).copy()\n\nbg_clean_path = PROCESSED_DIR / \"bg_clean_2272.gpkg\"\nstations_clean_path = PROCESSED_DIR / \"stations_clean_2272.gpkg\"\n\nbg_proj.to_file(bg_clean_path, layer=\"bg\", driver=\"GPKG\")\nstations_proj.to_file(stations_clean_path, layer=\"stations\", driver=\"GPKG\")\n\nprint(\"Saved:\", bg_clean_path)\nprint(\"Saved:\", stations_clean_path)",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "DataCleaning.html#interactive-block-group-map-with-socioeconomic-data",
    "href": "DataCleaning.html#interactive-block-group-map-with-socioeconomic-data",
    "title": "Data Processing",
    "section": "1.5 Interactive Block Group Map with Socioeconomic Data",
    "text": "1.5 Interactive Block Group Map with Socioeconomic Data\nWe created an interactive map using Folium to visualize demographic characteristics at the census block group level. The map includes a hover tooltip that displays each block group’s total population, median household income, number of zero-vehicle households, and number of bicycle commuters. This allows users to explore socioeconomic patterns across the city and provides important context for interpreting later need and access metrics.\n\n\nShow code\nimport folium\nfrom branca.element import Template, MacroElement\n\nblock_groups_acs[\"pop_total\"] = block_groups_acs[\"B01003_001E\"]\nblock_groups_acs[\"median_income\"] = block_groups_acs[\"B19013_001E\"]\nblock_groups_acs[\"zero_vehicle_households\"] = block_groups_acs[\"B25044_003E\"]\nblock_groups_acs[\"bike_commuters\"] = block_groups_acs[\"B08301_018E\"]\n\nbg_poly_wgs = block_groups_acs.to_crs(epsg=4326).copy()\nbg_proj_cent = block_groups_acs.copy()\nbg_proj_cent[\"centroid\"] = bg_proj_cent.geometry.centroid\nbg_proj_cent = bg_proj_cent.set_geometry(\"centroid\")\nbg_centroid_wgs = bg_proj_cent.to_crs(epsg=4326).copy()\n\ncenter_lat = bg_centroid_wgs.geometry.y.mean()\ncenter_lon = bg_centroid_wgs.geometry.x.mean()\n\nm_bg_acs = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\ndef style_bg_outline(feature):\n    return {\n        \"fillColor\": \"#f7fbff\",\n        \"color\": \"#cccccc\",\n        \"weight\": 0.4,\n        \"fillOpacity\": 0.4,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_bg_outline,\n    tooltip=folium.GeoJsonTooltip(\n        fields=[\n            \"GEOID\",\n            \"pop_total\",\n            \"median_income\",\n            \"zero_vehicle_households\",\n            \"bike_commuters\",\n        ],\n        aliases=[\n            \"GEOID\",\n            \"Total population\",\n            \"Median income (USD)\",\n            \"Zero-vehicle households\",\n            \"Bike commuters\",\n        ],\n        localize=True\n    )\n).add_to(m_bg_acs)\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Census Block Groups & ACS&lt;/b&gt;&lt;br&gt;\nBlock group boundaries with key&lt;br&gt;\nACS variables available in the&lt;br&gt;\ntooltip (population, income,&lt;br&gt;\nzero-vehicle households, and&lt;br&gt;\nbike commuters).\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_bg_acs.get_root().add_child(legend)\n\nm_bg_acs\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "DataCleaning.html#exploratory-map-of-active-indego-bike-stations",
    "href": "DataCleaning.html#exploratory-map-of-active-indego-bike-stations",
    "title": "Data Processing",
    "section": "1.6 Exploratory Map of Active Indego Bike Stations",
    "text": "1.6 Exploratory Map of Active Indego Bike Stations\nWe also mapped the current active Indego bike stations to visualize their spatial distribution across Philadelphia. This map helps illustrate where stations are located within block groups and highlights their concentration in the central parts of the city. As shown, most active stations are clustered in central Philadelphia, with limited extensions into South Philadelphia. This pattern reflects historical funding constraints and previous boundaries of the service area.\n\n\nShow code\nimport folium\nfrom branca.element import Template, MacroElement\n\nst_wgs = stations_gdf.to_crs(epsg=4326).copy()\nbg_poly_wgs = block_groups_acs.to_crs(epsg=4326).copy()\n\ncenter_lat = st_wgs.geometry.y.mean()\ncenter_lon = st_wgs.geometry.x.mean()\n\nm_stations = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=12,\n    tiles=\"CartoDB Positron\"\n)\n\ndef style_bg_gray(feature):\n    return {\n        \"fillColor\": \"rgba(0,0,0,0)\",\n        \"color\": \"#cccccc\",\n        \"weight\": 0.6,\n        \"fillOpacity\": 0.0,\n    }\n\nfolium.GeoJson(\n    bg_poly_wgs,\n    style_function=style_bg_gray,\n    name=\"Block Groups\"\n).add_to(m_stations)\n\nname_col = None\nfor c in [\"name\", \"station_name\", \"station\", \"kiosk_id\"]:\n    if c in st_wgs.columns:\n        name_col = c\n        break\n\nfor _, row in st_wgs.iterrows():\n    lat = row.geometry.y\n    lon = row.geometry.x\n    name_val = row[name_col] if name_col else f\"Station {row.name}\"\n\n    popup_html = f\"{name_col or 'Station'}: {name_val}\"\n\n    folium.CircleMarker(\n        location=[lat, lon],\n        radius=4,\n        color=\"#005b96\",\n        fill=True,\n        fill_color=\"#1f78b4\",\n        fill_opacity=0.95,\n        popup=popup_html\n    ).add_to(m_stations)\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 13px;\n  line-height: 1.4;\n\"&gt;\n\n&lt;b&gt;Existing Indego Stations&lt;/b&gt;&lt;br&gt;\nBlue points show current station&lt;br&gt;\nlocations. Light gray boundaries&lt;br&gt;\nrepresent census block groups&lt;br&gt;\nused in this analysis.\n\n&lt;/div&gt;\n\n{% endmacro %}\n\"\"\"\n\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_stations.get_root().add_child(legend)\n\nm_stations\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\n\n\nShow code\nbg_clean_path = PROCESSED_DIR / \"bg_clean_2272.gpkg\"\nstations_clean_path = PROCESSED_DIR / \"stations_clean_2272.gpkg\"\n\nbg_proj.to_file(bg_clean_path, layer=\"bg\", driver=\"GPKG\")\nstations_proj.to_file(stations_clean_path, layer=\"stations\", driver=\"GPKG\")\n\nprint(\"Saved:\", bg_clean_path)\nprint(\"Saved:\", stations_clean_path)",
    "crumbs": [
      "Analysis",
      "Data Processing"
    ]
  },
  {
    "objectID": "Conclusion.html",
    "href": "Conclusion.html",
    "title": "Conclusion",
    "section": "",
    "text": "Based on the equity gap measure (need score minus access score), five census block groups stand out as the highest-priority areas for Indego expansion. These locations show:\n\nHigh demographic or socioeconomic need\n\nLimited access to existing Indego stations\n\nGreater distances from bike facilities\n\nHigher likelihood of zero-vehicle households\n\nLower accessibility for residents who benefit most from Indego services\n\nThe interactive map below highlights:\n\nAll high-gap areas (light pink background polygons)\nTop 5 block groups (ranked in color from red → blue)\nPop-up attributes including median income, zero-vehicle rate, and bicycle commuting share\n\n\n\nShow code\nfrom pathlib import Path\nimport geopandas as gpd\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# base path\nBASE_DIR = Path(\".\").resolve()\nDATA_DIR = BASE_DIR / \"Data\"\nPROCESSED_DIR = DATA_DIR / \"processed\"\n\nprint(\"BASE_DIR:\", BASE_DIR)\nprint(\"PROCESSED_DIR:\", PROCESSED_DIR)\n\nbg = gpd.read_file(PROCESSED_DIR / \"bg_scores_2272.gpkg\", layer=\"scores\")\n\nbg.head()\n\n\n\n\n\nShow code\npop = pd.to_numeric(bg[\"B01003_001E\"], errors=\"coerce\")\nmedian_income = pd.to_numeric(bg[\"B19013_001E\"], errors=\"coerce\")\nzero_vehicle = pd.to_numeric(bg[\"B25044_003E\"], errors=\"coerce\")\nbike_commuters = pd.to_numeric(bg[\"B08301_018E\"], errors=\"coerce\")\n\nzero_vehicle_rate = zero_vehicle / pop.replace(0, np.nan)\nbike_share = bike_commuters / pop.replace(0, np.nan)\n\nbg[\"median_income\"] = median_income\nbg[\"zero_vehicle_rate\"] = zero_vehicle_rate\nbg[\"bike_share\"] = bike_share\n\nbg[[\"GEOID\", \"median_income\", \"zero_vehicle_rate\", \"bike_share\"]].head()\n\n\n\n\nShow code\nimport pandas as pd\n\nvalid = bg.dropna(subset=[\"equity_gap\"]).copy()\n\ngap_threshold = valid[\"equity_gap\"].quantile(0.75)\n\nhigh_gap = valid[valid[\"equity_gap\"] &gt;= gap_threshold].copy()\n\ntop5 = high_gap.sort_values(\"equity_gap\", ascending=False).head(5).copy()\n\nhigh_gap_wgs = high_gap.to_crs(epsg=4326).copy()\ntop5_wgs = top5.to_crs(epsg=4326).copy()\n\ntop5_wgs = top5_wgs.sort_values(\"equity_gap\", ascending=False).copy()\ntop5_wgs[\"rank\"] = range(1, len(top5_wgs) + 1)\n\nrest_wgs = high_gap_wgs[~high_gap_wgs[\"GEOID\"].isin(top5_wgs[\"GEOID\"])].copy()\n\nhigh_gap_wgs.shape, top5_wgs[[\"GEOID\", \"equity_gap\", \"rank\"]]\n\n\n\n\nShow code\nimport folium\nimport pandas as pd\nfrom branca.element import Template, MacroElement\n\ncenter_lat = high_gap_wgs.geometry.centroid.y.mean()\ncenter_lon = high_gap_wgs.geometry.centroid.x.mean()\n\nm_gap_priority = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\ndef fmt(val, digits=2):\n    if pd.isna(val):\n        return \"N/A\"\n    return f\"{val:.{digits}f}\"\n\nfor _, row in rest_wgs.iterrows():\n    popup_html = (\n        f\"GEOID: {row['GEOID']}&lt;br&gt;\"\n        f\"Need score: {fmt(row['need_score'])}&lt;br&gt;\"\n        f\"Access score: {fmt(row['access_score'])}&lt;br&gt;\"\n        f\"Equity gap: {fmt(row['equity_gap'])}&lt;br&gt;\"\n        f\"Median income: {fmt(row.get('median_income'), 0)}&lt;br&gt;\"\n        f\"Zero-vehicle rate: {fmt(row.get('zero_vehicle_rate'))}&lt;br&gt;\"\n        f\"Bicycle share: {fmt(row.get('bike_share'))}\"\n    )\n\n    folium.GeoJson(\n        row.geometry.__geo_interface__,\n        style_function=lambda f, fc=\"#EDD6D3\": {\n            \"fillColor\": fc,\n            \"color\": \"#ffffff\",\n            \"weight\": 0.8,\n            \"fillOpacity\": 0.80,\n        },\n        popup=folium.Popup(popup_html, max_width=280),\n        name=\"High equity gap (non-top 5)\"\n    ).add_to(m_gap_priority)\n\n\nrank_colors = {\n    1: \"#d73027\",  # red\n    2: \"#fc8d59\",  # orange\n    3: \"#fee08b\",  # yellow\n    4: \"#91bfdb\",  # light blue\n    5: \"#4575b4\",  # dark blue\n}\n\nfor _, row in top5_wgs.iterrows():\n    r = int(row[\"rank\"])\n    fill_color = rank_colors.get(r, \"#d73027\")\n\n    popup_html = (\n        f\"Rank: {r}&lt;br&gt;\"\n        f\"GEOID: {row['GEOID']}&lt;br&gt;\"\n        f\"Need score: {fmt(row['need_score'])}&lt;br&gt;\"\n        f\"Access score: {fmt(row['access_score'])}&lt;br&gt;\"\n        f\"Equity gap: {fmt(row['equity_gap'])}&lt;br&gt;\"\n        f\"Median income: {fmt(row.get('median_income'), 0)}&lt;br&gt;\"\n        f\"Zero-vehicle rate: {fmt(row.get('zero_vehicle_rate'))}&lt;br&gt;\"\n        f\"Bicycle share: {fmt(row.get('bike_share'))}\"\n    )\n\n    folium.GeoJson(\n        row.geometry.__geo_interface__,\n        style_function=lambda f, fc=fill_color: {\n            \"fillColor\": fc,\n            \"color\": \"#ffffff\",\n            \"weight\": 1.2, \n            \"fillOpacity\": 0.92,\n        },\n        popup=folium.Popup(popup_html, max_width=260),\n        name=f\"Top {r}\"\n    ).add_to(m_gap_priority)\n\nfolium.LayerControl().add_to(m_gap_priority)\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ddd;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 12px;\n  line-height: 1.4;\n  \"&gt;\n  \n  &lt;div style=\"font-weight: bold; margin-bottom: 6px;\"&gt;\n    Equity Priority Areas\n  &lt;/div&gt;\n\n  &lt;!-- High-gap base category --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 4px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#EDD6D3;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;High equity gap (others)&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;div style=\"margin-top: 8px; font-weight: 600;\"&gt;Top 5 block groups&lt;/div&gt;\n\n  &lt;!-- Rank 1 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#d73027;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 1 (highest gap)&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 2 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#fc8d59;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 2&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 3 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#fee08b;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 3&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 4 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#91bfdb;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 4&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 5 --&gt;\n  &lt;div style=\"display: flex; align-items: center;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#4575b4;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 5&lt;/span&gt;\n  &lt;/div&gt;\n\n&lt;/div&gt;\n{% endmacro %}\n\"\"\"\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_gap_priority.get_root().add_child(legend)\n\nm_gap_priority\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nThis map highlights the block groups with the highest equity gaps where social need substantially exceeds access to bicycle infrastructure. All high-gap block groups are shown in pink, providing a general picture of underserved parts of the city.\nThe five block groups with the greatest equity gaps are highlighted using a ranked color system (Rank 1 shown in the darkest red). These locations represent the most critical priority areas for future Indego expansion or bike lane investment.\nThe spatial pattern shows that the highest-priority block groups are located primarily in the Northeast and North Philadelphia areas, reflecting a combination of higher transportation need and limited existing bike infrastructure. These results help identify where targeted investments could most effectively reduce access disparities.",
    "crumbs": [
      "Analysis",
      "Conclusion"
    ]
  },
  {
    "objectID": "Conclusion.html#outcomes",
    "href": "Conclusion.html#outcomes",
    "title": "Conclusion",
    "section": "",
    "text": "Based on the equity gap measure (need score minus access score), five census block groups stand out as the highest-priority areas for Indego expansion. These locations show:\n\nHigh demographic or socioeconomic need\n\nLimited access to existing Indego stations\n\nGreater distances from bike facilities\n\nHigher likelihood of zero-vehicle households\n\nLower accessibility for residents who benefit most from Indego services\n\nThe interactive map below highlights:\n\nAll high-gap areas (light pink background polygons)\nTop 5 block groups (ranked in color from red → blue)\nPop-up attributes including median income, zero-vehicle rate, and bicycle commuting share\n\n\n\nShow code\nfrom pathlib import Path\nimport geopandas as gpd\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# base path\nBASE_DIR = Path(\".\").resolve()\nDATA_DIR = BASE_DIR / \"Data\"\nPROCESSED_DIR = DATA_DIR / \"processed\"\n\nprint(\"BASE_DIR:\", BASE_DIR)\nprint(\"PROCESSED_DIR:\", PROCESSED_DIR)\n\nbg = gpd.read_file(PROCESSED_DIR / \"bg_scores_2272.gpkg\", layer=\"scores\")\n\nbg.head()\n\n\n\n\n\nShow code\npop = pd.to_numeric(bg[\"B01003_001E\"], errors=\"coerce\")\nmedian_income = pd.to_numeric(bg[\"B19013_001E\"], errors=\"coerce\")\nzero_vehicle = pd.to_numeric(bg[\"B25044_003E\"], errors=\"coerce\")\nbike_commuters = pd.to_numeric(bg[\"B08301_018E\"], errors=\"coerce\")\n\nzero_vehicle_rate = zero_vehicle / pop.replace(0, np.nan)\nbike_share = bike_commuters / pop.replace(0, np.nan)\n\nbg[\"median_income\"] = median_income\nbg[\"zero_vehicle_rate\"] = zero_vehicle_rate\nbg[\"bike_share\"] = bike_share\n\nbg[[\"GEOID\", \"median_income\", \"zero_vehicle_rate\", \"bike_share\"]].head()\n\n\n\n\nShow code\nimport pandas as pd\n\nvalid = bg.dropna(subset=[\"equity_gap\"]).copy()\n\ngap_threshold = valid[\"equity_gap\"].quantile(0.75)\n\nhigh_gap = valid[valid[\"equity_gap\"] &gt;= gap_threshold].copy()\n\ntop5 = high_gap.sort_values(\"equity_gap\", ascending=False).head(5).copy()\n\nhigh_gap_wgs = high_gap.to_crs(epsg=4326).copy()\ntop5_wgs = top5.to_crs(epsg=4326).copy()\n\ntop5_wgs = top5_wgs.sort_values(\"equity_gap\", ascending=False).copy()\ntop5_wgs[\"rank\"] = range(1, len(top5_wgs) + 1)\n\nrest_wgs = high_gap_wgs[~high_gap_wgs[\"GEOID\"].isin(top5_wgs[\"GEOID\"])].copy()\n\nhigh_gap_wgs.shape, top5_wgs[[\"GEOID\", \"equity_gap\", \"rank\"]]\n\n\n\n\nShow code\nimport folium\nimport pandas as pd\nfrom branca.element import Template, MacroElement\n\ncenter_lat = high_gap_wgs.geometry.centroid.y.mean()\ncenter_lon = high_gap_wgs.geometry.centroid.x.mean()\n\nm_gap_priority = folium.Map(\n    location=[center_lat, center_lon],\n    zoom_start=11,\n    tiles=\"CartoDB Positron\"\n)\n\ndef fmt(val, digits=2):\n    if pd.isna(val):\n        return \"N/A\"\n    return f\"{val:.{digits}f}\"\n\nfor _, row in rest_wgs.iterrows():\n    popup_html = (\n        f\"GEOID: {row['GEOID']}&lt;br&gt;\"\n        f\"Need score: {fmt(row['need_score'])}&lt;br&gt;\"\n        f\"Access score: {fmt(row['access_score'])}&lt;br&gt;\"\n        f\"Equity gap: {fmt(row['equity_gap'])}&lt;br&gt;\"\n        f\"Median income: {fmt(row.get('median_income'), 0)}&lt;br&gt;\"\n        f\"Zero-vehicle rate: {fmt(row.get('zero_vehicle_rate'))}&lt;br&gt;\"\n        f\"Bicycle share: {fmt(row.get('bike_share'))}\"\n    )\n\n    folium.GeoJson(\n        row.geometry.__geo_interface__,\n        style_function=lambda f, fc=\"#EDD6D3\": {\n            \"fillColor\": fc,\n            \"color\": \"#ffffff\",\n            \"weight\": 0.8,\n            \"fillOpacity\": 0.80,\n        },\n        popup=folium.Popup(popup_html, max_width=280),\n        name=\"High equity gap (non-top 5)\"\n    ).add_to(m_gap_priority)\n\n\nrank_colors = {\n    1: \"#d73027\",  # red\n    2: \"#fc8d59\",  # orange\n    3: \"#fee08b\",  # yellow\n    4: \"#91bfdb\",  # light blue\n    5: \"#4575b4\",  # dark blue\n}\n\nfor _, row in top5_wgs.iterrows():\n    r = int(row[\"rank\"])\n    fill_color = rank_colors.get(r, \"#d73027\")\n\n    popup_html = (\n        f\"Rank: {r}&lt;br&gt;\"\n        f\"GEOID: {row['GEOID']}&lt;br&gt;\"\n        f\"Need score: {fmt(row['need_score'])}&lt;br&gt;\"\n        f\"Access score: {fmt(row['access_score'])}&lt;br&gt;\"\n        f\"Equity gap: {fmt(row['equity_gap'])}&lt;br&gt;\"\n        f\"Median income: {fmt(row.get('median_income'), 0)}&lt;br&gt;\"\n        f\"Zero-vehicle rate: {fmt(row.get('zero_vehicle_rate'))}&lt;br&gt;\"\n        f\"Bicycle share: {fmt(row.get('bike_share'))}\"\n    )\n\n    folium.GeoJson(\n        row.geometry.__geo_interface__,\n        style_function=lambda f, fc=fill_color: {\n            \"fillColor\": fc,\n            \"color\": \"#ffffff\",\n            \"weight\": 1.2, \n            \"fillOpacity\": 0.92,\n        },\n        popup=folium.Popup(popup_html, max_width=260),\n        name=f\"Top {r}\"\n    ).add_to(m_gap_priority)\n\nfolium.LayerControl().add_to(m_gap_priority)\n\nlegend_html = \"\"\"\n{% macro html(this, kwargs) %}\n&lt;div style=\"\n  position: fixed;\n  bottom: 20px;\n  left: 20px;\n  z-index: 9999;\n  background-color: white;\n  padding: 12px 14px;\n  border: 1px solid #ddd;\n  border-radius: 6px;\n  box-shadow: 0 0 10px rgba(0,0,0,0.15);\n  font-size: 12px;\n  line-height: 1.4;\n  \"&gt;\n  \n  &lt;div style=\"font-weight: bold; margin-bottom: 6px;\"&gt;\n    Equity Priority Areas\n  &lt;/div&gt;\n\n  &lt;!-- High-gap base category --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 4px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#EDD6D3;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;High equity gap (others)&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;div style=\"margin-top: 8px; font-weight: 600;\"&gt;Top 5 block groups&lt;/div&gt;\n\n  &lt;!-- Rank 1 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#d73027;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 1 (highest gap)&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 2 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#fc8d59;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 2&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 3 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#fee08b;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 3&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 4 --&gt;\n  &lt;div style=\"display: flex; align-items: center; margin-bottom: 2px;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#91bfdb;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 4&lt;/span&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Rank 5 --&gt;\n  &lt;div style=\"display: flex; align-items: center;\"&gt;\n    &lt;span style=\"\n        display:inline-block;\n        width:14px;\n        height:14px;\n        background:#4575b4;\n        border:1px solid #ffffff;\n        margin-right:6px;\"&gt;\n    &lt;/span&gt;\n    &lt;span&gt;Rank 5&lt;/span&gt;\n  &lt;/div&gt;\n\n&lt;/div&gt;\n{% endmacro %}\n\"\"\"\nlegend = MacroElement()\nlegend._template = Template(legend_html)\nm_gap_priority.get_root().add_child(legend)\n\nm_gap_priority\n\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook\n\n\nThis map highlights the block groups with the highest equity gaps where social need substantially exceeds access to bicycle infrastructure. All high-gap block groups are shown in pink, providing a general picture of underserved parts of the city.\nThe five block groups with the greatest equity gaps are highlighted using a ranked color system (Rank 1 shown in the darkest red). These locations represent the most critical priority areas for future Indego expansion or bike lane investment.\nThe spatial pattern shows that the highest-priority block groups are located primarily in the Northeast and North Philadelphia areas, reflecting a combination of higher transportation need and limited existing bike infrastructure. These results help identify where targeted investments could most effectively reduce access disparities.",
    "crumbs": [
      "Analysis",
      "Conclusion"
    ]
  },
  {
    "objectID": "Conclusion.html#limitations",
    "href": "Conclusion.html#limitations",
    "title": "Conclusion",
    "section": "2. Limitations",
    "text": "2. Limitations\nSeveral limitations should be considered when interpreting the results of this analysis.\nWhile the indicators provide a structured view of need, access, and equity, they rely on datasets and assumptions with inherent uncertainty.\n\nIndego coverage remains concentrated in central Philadelphia.\nThe spatial distribution of current stations is heavily centered around the urban core. Areas outside this boundary show low access not necessarily because they are underserved, but because they fall beyond Indego’s existing operating range. This affects how equity gaps appear across the region and may overstate unmet need in neighborhoods that Indego is not currently designed to serve.\nOSM-based bike facility data may be incomplete or inconsistent.\nOpenStreetMap is a valuable but community-driven dataset. Some bike lanes may be missing, mislabeled, or outdated depending on contributor activity. As a result, the calculated distance to bike facilities may not fully capture real on-the-ground conditions, especially in neighborhoods where mapping participation is lower.\nACS block group variables carry sampling error and missing values.\nBlock group data provides fine geographic detail, but estimates at this scale come with high margins of error. Some variables contain missing or suppressed values, which can influence the need score and introduce noise into the analysis. The results should therefore be interpreted as indicative patterns rather than precise measurements.\nAccessibility metrics do not reflect actual behavior or perception.\nThe analysis measures potential access based on distance and infrastructure—not actual ridership, comfort, cultural factors, or perceived safety. A neighborhood may score well on access but still experience low usage due to safety concerns, street design, or socioeconomic factors. Conversely, low-access areas may have strong demand that is not captured by spatial indicators alone.",
    "crumbs": [
      "Analysis",
      "Conclusion"
    ]
  },
  {
    "objectID": "Conclusion.html#summary-and-planning-implications",
    "href": "Conclusion.html#summary-and-planning-implications",
    "title": "Conclusion",
    "section": "3. Summary and Planning Implications",
    "text": "3. Summary and Planning Implications\nThis analysis integrates demographic indicators, transportation infrastructure, and spatial accessibility to evaluate how well Indego currently serves Philadelphia’s neighborhoods. By comparing need and access at the block-group level, the results highlight areas where high social or mobility need does not match the availability of bike-share stations or nearby bicycle facilities. These spatial mismatches help reveal where the existing Indego network aligns with community characteristics and where service gaps remain.\nFrom a planning perspective, the combined need–access–equity framework offers a replicable way to assess expansion opportunities. Neighborhoods with high need and consistently low access emerge as potential candidates for new stations or improved multimodal connections. These findings also suggest that future investments should consider not only the density of stations but also the quality of adjoining bike infrastructure, since access by distance alone does not guarantee safe or comfortable routes.\nWhile the indicators are influenced by data limitations and do not capture behavioral factors or perceptions of safety, they provide a meaningful starting point for identifying underserved areas. The results support discussions about equitable expansion, strategic placement of new stations, and the integration of bike-share planning with broader mobility, public health, and neighborhood-level investment strategies.",
    "crumbs": [
      "Analysis",
      "Conclusion"
    ]
  }
]